---
import ThemeToggle from './ThemeToggle.astro';
import { siteConfig } from '@/data/site';

const navLinks = [
  { label: 'Home', href: '/' },
  { label: 'Blog', href: '/blog' },
  { label: 'CV', href: '/cv' },
  { label: 'Tags', href: '/tags' },
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 backdrop-blur-md bg-white/80 dark:bg-gray-950/80 border-b border-gray-200 dark:border-gray-800">
  <div class="max-w-4xl mx-auto px-4 py-4 flex items-center justify-between">
    <a href="/" class="text-xl font-extrabold bg-gradient-to-r from-indigo-500 to-purple-500 bg-clip-text text-transparent hover:from-indigo-400 hover:to-purple-400 transition-all">
      {siteConfig.title}
    </a>

    <!-- Mobile menu button -->
    <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" aria-label="Toggle menu">
      <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
      </svg>
    </button>

    <!-- Desktop nav -->
    <nav class="hidden md:flex items-center gap-6">
      {navLinks.map(link => (
        <a
          href={link.href}
          class:list={[
            'text-sm font-medium transition-colors',
            currentPath === link.href || (link.href !== '/' && currentPath.startsWith(link.href))
              ? 'text-indigo-500 dark:text-indigo-400'
              : 'text-gray-600 dark:text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400',
          ]}
        >
          {link.label}
        </a>
      ))}
      <ThemeToggle />
    </nav>
  </div>

  <!-- Mobile nav -->
  <nav id="mobile-menu" class="hidden md:hidden border-t border-gray-200 dark:border-gray-800 bg-white/95 dark:bg-gray-950/95 backdrop-blur-md">
    <div class="max-w-4xl mx-auto px-4 py-4 flex flex-col gap-4">
      {navLinks.map(link => (
        <a
          href={link.href}
          class:list={[
            'text-sm font-medium transition-colors',
            currentPath === link.href || (link.href !== '/' && currentPath.startsWith(link.href))
              ? 'text-indigo-500 dark:text-indigo-400'
              : 'text-gray-600 dark:text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400',
          ]}
        >
          {link.label}
        </a>
      ))}
      <ThemeToggle />
    </div>
  </nav>
</header>

<script is:inline>
  function setupMobileMenu() {
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');
    btn?.addEventListener('click', () => {
      menu?.classList.toggle('hidden');
    });
  }
  setupMobileMenu();
  document.addEventListener('astro:after-swap', setupMobileMenu);
</script>
